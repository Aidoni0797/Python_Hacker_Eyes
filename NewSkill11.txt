Функции для работы с URL

В список возможных операций с URL входят:
- отправка  URL на сервер для анализа;
- получение информации об URL;
- анализ URL;
- получение комментариев пользователей VIrusTotal по нужному URL;
- отправка своих комментариев по определенному URL;
- получение результатов голосования по определенному URL;
- отправка своего голоса за какой-либо URL;
- получение расширенной информации о URL;
- получение информации о домене или IP-адресе нужного URL.

Большая часть указанных операций (за исключением последней) выполняется аналогично таким же
операциям с файлами. При этом в качестве идентификатора URL может вымтупать либо строка с URL,
закодированная в Base64 без добавочных знаков "равно", либо хеш SHA-256 from URL. 
Реализовать это можно так:
#Для Base64
import Base64

id url = base64.urlsafe_b64encode(url.encode('utf-8')).decode('utf-8').rstrip('=')

#Для SHA-256
import hashlib

id_url = hashlib.sha256(url.encode()).hexdigest()

Чтобы отправить URL для анализа, нужно использовать POST-запрос:

data = ('url': '<строка с именем URL>')
api_url = 'https://www.virustotal.com/api/v3/urls'
headers = ('x-apikey':  '<ключ доступа к API>')
response = requests.post(api_url, headers=headers, data=data)

В ответ мы увидим дескриптор URL (по аналогии с дескриптором файла):
{
	"data":{
		"id": "u-1a565d28f8412c3e4b65ec8267ff8e77eb00a2c76367e653be774169ca9d09a6-1577904977",
		"type": "analysis"
	}
}

Идентификатор id из этого дескриптора используем для получения информации об анализе файла
через GET-запрос типа /analyses (об этом запросе ближе к концу главы).

Получить информацию о доменах или IP-адресах, связанных с каким-либо URL, можно, применив
GET-запрос типа /network_location(здесь используем Base64 or SHA-256 идентификатор URL):

api_url = 'https://www.virustotal.com/api/v3/urls/<идентификатор URL(Base64 or SHA-256)>/network_location'
headers = {'x-apikey': '<ключ доступа к API>'}
response = requests.post(api_url, headers=headers)

Остальные операции с URL выполняются так же, как и аналогичные операции работы с файлами.