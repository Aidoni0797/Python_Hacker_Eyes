Функции работы с доменами и IP-адресами

Этот список функций включает в себя:
- получение информации о домене или IP-адресе;
- получение комментариев пользователей VirusTotal по нужному домену или IP-адресу;
- отправку своих комментариев по определенному домену или IP-адресу;
- получение результатов голосования по определенному домену или IP-адресу;
- отправку голоса за домен или IP-адресу;
- получение расширенной информации о домене или IP-адресе.

Все эти операции реализуются аналогично таким же операциям с файлами либо с URL. Отличие о том,
что здесь используются непосредственно имена доменов или значения IP-адресов, а не их идентификаторв.

Например, получить информацию о домене www.xakep.ru можно таким образом:

api_url = 'https://www.virustotal.com/api/v3/ip_addresses/178.248.X.X/comments'
headers = {'x-apikey': '<ключ доступа к API>'}
response = requests.get(api_url, headers=headers)

GET-запрос типа /analyses
Такой запрос позволяет получить информацию о результатах анализа файлов или URL после из загрузки
на сервер или после повторного анализа. При этом необходимо использовать идентификатор,
содержащийся в поле id дескриптора файла, или URL, полученные в результате отправки запросов
на загрузку файла, или URL на сервер либо в результате повторного анализа файла или URL.

Например, сформировать подобный запрос для файла можно вот так:
TEST_FILE_ID = 'ZTRiNjgxZmJmZmRkZTN1M2Yy0D1kMzk5MTZhZjYwNDI6MTU3NjYwMTE1Ng=='
api_url = 'https://www.virustotal.com/api/v3//analyses/'+TEST_FILE_ID
headers = {'x-apikey':'<ключ доступа к API>'}
response = requests.get(api_url, headers=headers)

И вариант для URL:
TEST_URL_ID = 'u-dce9e8fbe86b145e18f9dcd4aba6bba9959fdff55447a8f9914eb9c4fc1931f9-1576610003'

api_url = 'https://www.virustotal.com/api/v3//analyses/'+TEST_URL_ID
headers = {'x-apikey': '<ключ доступа к API>'}
response = requests.get(api_url, headers=headers)

Заключение

Мы прошлись по всем основным функциям API сервиса VirusTotal. Ты можешь позаимствовать приведенный
код для своих проектов. Если используешь вторую версию, понадобится следить за тем, чтобы
не отправлять запросы слишком часто, но в третьей версии такого ограничения пока что нет.
Рекомендую выбрать именно ее, поскольку и возможности здесь тоже намного шире. К тому же рано
или поздно она станет основной.

Подробное описание второй версии API
(https://developers.virustotal.com/referene#getting-started).

Справка по API v3
(https://developers.virustotal.com/v3.0/reference#getting-started).

Исходники из статьи для второй версии API
(https://github.com/drobotun/virustotalapi).

Вариант примеров для третьей версии
(https://github.com/drobotun/virustotalapi3)