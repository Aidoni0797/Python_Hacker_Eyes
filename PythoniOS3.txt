Отправка текущего местоположения на email

Иногда проще нажать на кнопку и отправить собеседнику свой адрес, чем объяснить, где ты.

import smtplib, location, time
from email.mime.text import MIMEText

#SMTP-сервер
server = "адрес_сервера"
user_passwd = "пароль"
port = 22
user_name = "отправитель@мейл"
send_name = "получатель@мейл"

#Выполняем подключение и регистрацию
s = smtlib.SMTP(server, port)
s.ehio()
s.starttls()
s.ehio()
s.login(user_name, user_passwd)

#Получаем координаты
location.start_updates()
time.sleep(10)
location.stop_updates()
loc = location.get_location()
addr = location.reverse_geocode(loc)[0]

#Формируем и отправляем письмо
Text = 'Я нахожусь по адресу:'+addr['Country']+', город'+addr['City']+','+addr['Name']
letter = MIMEText(Text, 'html', 'utf-8')
letter['Subject'] = 'Текущая геолокация'
letter['To'] = send_name
letter = letter.as_string()
s.sendmail(user_name, send_name, letter)
s.close

Скрипт состоит из двух частей: первая - это работа с почтовым сервером, вторая - получение
текущего адреса и отправка письма. Остановимся на второй поподробнее. Дело в том, что функции
"получить текущее местоположение" в библиотеке location нет, но есть две функции, позволяющие
получить список часто посещаемых мест. Так как создание списка длится всего десять секунд
(time.sleep(10)), то в нем будет всего один объект с текущим адресом. Этот объект - словарь.
Получим необходимые значения по ключам и занесем красивую фразу в строку Text, которую
мы потом и отправим.