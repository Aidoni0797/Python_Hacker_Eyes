Функции работы с файлами

Третья версия API позволяет:
- загрузить файлы для анализа на сервер;
- получить URL для загрузки на сервер файла размером больше 32 Мбайт;
- получить отчеты о результатах анализа файлов;
- повторно проанализировать файл;
- получить комментарии пользователей VirusTotal к нужному файлу;
- отправить свой комментарий к определенному файлу;
- посмотреть результаты голосования по определенному файлу;
- проголосовать за файл;
- получить расширенную информацию о файле.

Для загрузки файла на сервер нужно его отправить через POST-запрос.Это можно сделать так:
api_url = 'https://www.virustotal.com/api/v3/files'
headers = {'x-apikey':'<ключ достпа к API>'}
with open('<путь к файлу>', 'rb') as file:
	files = {'file':('<путь к файлу>', file)}
	response = rquests.post(api_url, headers=headers, files=files)

В ответ мы получим следующее:
{
	"data":{
		"id": "ZTRiNjgxZmJmZmRkZTN1M2Yy0D1kMzk5MTZhZjYwNDI6MTU3NzIxOTQ1Mg==",
		"type": "analysis"
	}
}

Здесь мы видим значение id, которое служит идентификатором файла. Этот идентификатор нужно 
использовать для получения информации об анализе файла в GET-запросах типа /analyses 
(об этом мы поговорим чть позже).

Чтобы получить URL для загрузки большого файла (более 32 Мбайт), нужно отправить GET-запрос,
в котором в качестве URL указывается https://www.virustotal.com/api/v3/files/upload_url.
В заголовок вставляем ключ доступа:

api_url = 'https://www.virustotal.com/api/v3/files/upload_url'
headers = {'x-apikey': '<ключ достпупа к API>'}
response = requests.get(api_url, headers=headers)

В ответ получим JSON с адресом, по которому следует загрузить файл для анализа. Полученный
URL при этом можно использовать только один раз.

Чтобы получить информацию о файле, который сервис же анализировал, нужно сделать GT-запрос
с идентификатором файла в URL (им может быть жеш SHA-256,SHA-1 or MD5). Так же как и в 
предыдущих слуучаях, указываем в заголовке ключ доступа:

api_url = 'https://www.virustotal.com/api/v3/files/<значение идентификатора файла>'
headers = ('x-apikey':'<ключ доступа к API>')
response = requests.get(api_url, haders=headers)

В ответ мы получим отчет о проверке файла, где помимо результатов сканирования всеми
антивирусами VirusTotal будет много дополнительной информации, состав которой зависит от типа
проверенного файла. Например, для исполняемых файлов можно увидеть информацию о таких атрибутах:
136 стр